#!/usr/bin/env python3
"""
Extract contact data matrices from the provided screenshots and plot against force.
"""

import numpy as np
import matplotlib.pyplot as plt

# Data extracted from your 9 screenshots
# Format: (force_N, matrix_data)

# Frame #2921 - First image (no force label visible, assuming baseline or low force)
frame_2921 = np.array([
    [0.0, 1.0, 1.0, 1.0, 5.0, 3.0, 1.0, 0.0, -3.0, -3.0, -2.0, -3.0, -4.0, -3.0, -2.0, -1.0],
    [-1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 2.0, 0.0, -3.0, -2.0, -2.0, -4.0, -5.0, -4.0, -3.0],
    [-2.0, -1.0, -5.0, -3.0, 4.0, 2.0, 7.0, 4.0, -1.0, -4.0, -2.0, -1.0, -1.0, 0.0, -1.0, -3.0],
    [-7.0, -8.0, -5.0, 1.0, 10.0, 16.0, 15.0, 16.0, 20.0, 18.0, 8.0, 8.0, 2.0, 2.0, 0.0, -7.0],
    [0.0, 1.0, -2.0, 7.0, 11.0, 10.0, 7.0, 11.0, 9.0, 11.0, 3.0, 10.0, 5.0, 0.0, 0.0, -3.0],
    [-6.0, -3.0, -2.0, 9.0, 11.0, 8.0, 0.0, 4.0, 4.0, 4.0, 3.0, 15.0, 17.0, 2.0, 1.0, -4.0],
    [-4.0, -2.0, 0.0, 1.0, 1.0, -5.0, -6.0, -1.0, -2.0, -2.0, 1.0, 7.0, 24.0, -3.0, -3.0, -6.0],
    [-4.0, -5.0, -3.0, -3.0, 0.0, -5.0, -6.0, -3.0, -4.0, -4.0, -2.0, -1.0, 5.0, -1.0, 0.0, -1.0],
    [-4.0, -3.0, -2.0, 1.0, 3.0, -1.0, 1.0, 1.0, 1.0, -1.0, 3.0, 4.0, 11.0, 4.0, 1.0, -1.0],
    [-3.0, 2.0, 9.0, 32.0, 24.0, 12.0, 2.0, 0.0, -1.0, 1.0, 8.0, 2.0, 10.0, -6.0, -5.0, -8.0],
    [1.0, 0.0, -4.0, 3.0, 6.0, 6.0, -2.0, 0.0, -1.0, 4.0, 5.0, 0.0, 12.0, 2.0, 2.0, -1.0],
    [0.0, 1.0, 1.0, 6.0, 7.0, 7.0, 1.0, 4.0, 4.0, 10.0, 16.0, 7.0, 5.0, 3.0, -2.0, -3.0],
    [-1.0, 0.0, 1.0, 3.0, 5.0, 7.0, 6.0, 8.0, 9.0, 10.0, 7.0, 3.0, 2.0, 1.0, -2.0, -1.0],
    [3.0, 4.0, 2.0, 6.0, 3.0, 3.0, 0.0, 1.0, 1.0, 2.0, 4.0, 4.0, 0.0, 2.0, -1.0, 1.0],
    [5.0, 7.0, 3.0, 3.0, 0.0, 0.0, -3.0, 1.0, -1.0, -3.0, 1.0, 0.0, -2.0, -1.0, -1.0, 1.0],
    [4.0, 6.0, 7.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 5.0, 3.0, 2.0, 1.0, -1.0, 0.0]
])

# Frame #4162 - Second image
frame_4162 = np.array([
    [4.0, 2.0, 0.0, 3.0, 7.0, 9.0, 12.0, 12.0, 4.0, 1.0, 0.0, -2.0, -3.0, -5.0, -7.0, -6.0],
    [-2.0, -2.0, -3.0, -2.0, 2.0, -1.0, 0.0, 2.0, 1.0, -1.0, 0.0, -1.0, 1.0, -2.0, -1.0, -3.0],
    [-1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 1.0, 3.0, -2.0, -1.0, 0.0, -1.0, -1.0, -2.0, -2.0, -4.0],
    [-5.0, -2.0, -2.0, 3.0, 8.0, 4.0, 4.0, 5.0, 7.0, 6.0, 2.0, 0.0, 3.0, -5.0, -3.0, -6.0],
    [-1.0, 2.0, -1.0, 0.0, 2.0, 0.0, 0.0, -1.0, -4.0, -2.0, -3.0, -1.0, 0.0, -2.0, -1.0, -3.0],
    [0.0, 0.0, 0.0, 1.0, -1.0, -1.0, -1.0, 3.0, 3.0, -1.0, -8.0, -12.0, -8.0, -10.0, -8.0, -7.0],
    [-1.0, 0.0, 0.0, 3.0, -4.0, -3.0, -4.0, -2.0, 0.0, 0.0, -3.0, -2.0, 15.0, 8.0, 2.0, -7.0],
    [-6.0, -6.0, -1.0, 2.0, -3.0, -2.0, -4.0, -5.0, -5.0, -5.0, -2.0, 13.0, 15.0, 3.0, 3.0, -4.0],
    [-2.0, -7.0, 1.0, 8.0, 0.0, 1.0, 3.0, 4.0, 0.0, -6.0, 6.0, 23.0, 18.0, 23.0, 12.0, -2.0],
    [-3.0, -7.0, 1.0, 9.0, 6.0, 4.0, -1.0, -3.0, -5.0, 21.0, 48.0, 26.0, 19.0, 13.0, 0.0, -16.0],
    [-7.0, -6.0, -3.0, 1.0, 3.0, 4.0, 2.0, 1.0, 13.0, 43.0, 43.0, 13.0, 12.0, 14.0, 10.0, -4.0],
    [-5.0, -3.0, -3.0, -3.0, -5.0, -3.0, -5.0, -1.0, 16.0, 47.0, 52.0, 29.0, 26.0, 8.0, 2.0, -7.0],
    [-3.0, -5.0, 0.0, -1.0, 1.0, 5.0, 6.0, 18.0, 33.0, 33.0, 34.0, 37.0, 27.0, -1.0, -9.0, -12.0],
    [4.0, 2.0, 1.0, 1.0, 3.0, 4.0, 10.0, 18.0, 28.0, 42.0, 24.0, 26.0, 19.0, 0.0, -6.0, -6.0],
    [-2.0, -2.0, 0.0, 1.0, -1.0, 1.0, 5.0, 10.0, 18.0, 32.0, 17.0, 19.0, 11.0, -6.0, -13.0, -5.0],
    [-1.0, -1.0, 1.0, 0.0, 2.0, 5.0, 11.0, 11.0, 4.0, 0.0, 0.0, 0.0, 3.0, -7.0, -10.0, -2.0]
])

# Frame #2838 - Third image
frame_2838 = np.array([
    [3.0, 1.0, -1.0, -2.0, -6.0, -2.0, -2.0, -1.0, -2.0, -1.0, 0.0, 0.0, 0.0, 2.0, 1.0, 2.0],
    [2.0, 1.0, 1.0, 0.0, -2.0, -1.0, -2.0, 1.0, -2.0, -2.0, -3.0, -4.0, -5.0, -4.0, -2.0, 1.0],
    [-2.0, 1.0, 0.0, 1.0, -2.0, -1.0, 0.0, 2.0, -3.0, 0.0, -1.0, 0.0, -2.0, 0.0, 0.0, 0.0],
    [-5.0, -2.0, 0.0, 1.0, -1.0, -1.0, -4.0, 6.0, 11.0, 9.0, 5.0, 0.0, 2.0, 0.0, 3.0, -1.0],
    [0.0, 2.0, 2.0, 1.0, 0.0, 1.0, 0.0, 7.0, 10.0, 9.0, 3.0, -1.0, 2.0, -1.0, -1.0, -4.0],
    [-2.0, 1.0, 2.0, 2.0, 3.0, 6.0, 1.0, 6.0, 0.0, 0.0, 1.0, 2.0, 6.0, 5.0, 3.0, -5.0],
    [-3.0, -1.0, 1.0, -5.0, -4.0, -5.0, 11.0, 22.0, 0.0, -6.0, -5.0, 0.0, 14.0, 1.0, 1.0, -4.0],
    [-6.0, -2.0, 0.0, 0.0, 1.0, 8.0, 11.0, 20.0, -8.0, -3.0, 4.0, 11.0, 8.0, -3.0, 0.0, -5.0],
    [-12.0, -5.0, 9.0, 6.0, 8.0, 21.0, 23.0, 5.0, 0.0, 3.0, 15.0, 8.0, 6.0, 4.0, 5.0, -2.0],
    [-11.0, -9.0, 3.0, 17.0, 16.0, 16.0, 5.0, 1.0, 5.0, 31.0, 39.0, 9.0, -4.0, -5.0, 2.0, -3.0],
    [-6.0, -1.0, 1.0, 2.0, 10.0, 5.0, 0.0, 0.0, 26.0, 37.0, 28.0, 0.0, -9.0, -8.0, 1.0, -3.0],
    [-11.0, -5.0, -2.0, -1.0, 0.0, 1.0, 1.0, 11.0, 14.0, 22.0, 22.0, 0.0, -4.0, -6.0, -2.0, -5.0],
    [0.0, -1.0, 1.0, 0.0, -1.0, 0.0, 4.0, 15.0, 15.0, 12.0, 3.0, -1.0, -2.0, -3.0, -2.0, -3.0],
    [0.0, 1.0, 2.0, 1.0, -3.0, -5.0, -4.0, 2.0, 3.0, 2.0, -2.0, 2.0, 8.0, 0.0, 2.0, 1.0],
    [-4.0, -2.0, -3.0, 0.0, -1.0, 2.0, 1.0, 7.0, 6.0, 4.0, 3.0, -1.0, -1.0, -4.0, -2.0, -2.0],
    [-5.0, -2.0, -3.0, -1.0, -4.0, -4.0, -5.0, -2.0, -2.0, 1.0, 0.0, 3.0, 8.0, 5.0, 8.0, 7.0]
])

# Frame #2589 - Fourth image
frame_2589 = np.array([
    [1.0, -1.0, -2.0, -3.0, -2.0, 0.0, -4.0, -3.0, -1.0, 0.0, 0.0, 1.0, -1.0, 3.0, 5.0, 2.0],
    [1.0, 2.0, 1.0, -1.0, 3.0, 2.0, -1.0, 0.0, 0.0, 1.0, -2.0, -1.0, -3.0, -2.0, 0.0, -1.0],
    [0.0, 1.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 1.0, -2.0, -1.0, -2.0, -6.0, -7.0, -5.0],
    [1.0, 1.0, -1.0, -4.0, 0.0, 8.0, 4.0, 5.0, 7.0, 11.0, 4.0, 6.0, 2.0, -4.0, -3.0, -3.0],
    [-6.0, -6.0, -2.0, -4.0, 5.0, 4.0, 1.0, 4.0, -7.0, 2.0, 2.0, 9.0, 9.0, -3.0, -3.0, -4.0],
    [-9.0, -6.0, -4.0, -1.0, 3.0, 1.0, -2.0, 0.0, 3.0, 3.0, 6.0, 17.0, 17.0, 1.0, 0.0, -3.0],
    [-9.0, -4.0, -1.0, 0.0, -1.0, 1.0, 0.0, 0.0, 0.0, -4.0, 4.0, 5.0, 9.0, 2.0, 0.0, 3.0],
    [0.0, 1.0, 2.0, 3.0, 1.0, 1.0, -3.0, 1.0, -3.0, -6.0, -2.0, -1.0, 6.0, 1.0, -1.0, 0.0],
    [1.0, 1.0, 3.0, 7.0, -9.0, -8.0, -6.0, -3.0, -1.0, -5.0, 2.0, -2.0, 5.0, 5.0, 2.0, 2.0],
    [-6.0, -7.0, -2.0, 2.0, 5.0, 6.0, -1.0, -1.0, -2.0, -1.0, 6.0, 2.0, 9.0, 4.0, 2.0, 0.0],
    [-10.0, -7.0, -4.0, 3.0, 8.0, 10.0, 1.0, -1.0, 0.0, 3.0, 3.0, -7.0, 7.0, -2.0, 2.0, 0.0],
    [-7.0, -4.0, -1.0, -1.0, 3.0, 3.0, -1.0, 2.0, 3.0, 10.0, 12.0, 1.0, 5.0, -3.0, -4.0, -1.0],
    [-7.0, -8.0, -2.0, -1.0, 6.0, 10.0, 6.0, 6.0, 4.0, 7.0, 2.0, -2.0, -3.0, -3.0, -4.0, 1.0],
    [-5.0, -3.0, -2.0, -8.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 1.0, 1.0, -4.0, -2.0, -2.0, 3.0],
    [-5.0, -8.0, -5.0, -9.0, -4.0, -1.0, 0.0, -1.0, -1.0, 1.0, 3.0, 3.0, 0.0, -2.0, -7.0, -1.0],
    [-2.0, -2.0, 2.0, -3.0, -1.0, 0.0, 1.0, 2.0, 0.0, 1.0, -1.0, 1.0, -2.0, -3.0, -8.0, -4.0]
])

# Frame #1335 - Fifth image
frame_1335 = np.array([
    [0.0, 0.0, 0.0, 1.0, -1.0, 0.0, -2.0, -3.0, -4.0, -7.0, -5.0, -6.0, -6.0, -2.0, 1.0, 2.0],
    [0.0, -1.0, 1.0, 1.0, 0.0, 1.0, 0.0, -2.0, -3.0, -4.0, -2.0, -3.0, 0.0, 2.0, 4.0, 3.0],
    [-1.0, 0.0, 1.0, 2.0, 3.0, 2.0, -1.0, -4.0, 0.0, -1.0, 0.0, -1.0, 0.0, -3.0, 0.0, 0.0],
    [-2.0, 1.0, 2.0, 1.0, -2.0, 1.0, 2.0, -4.0, -9.0, -6.0, 0.0, 2.0, 0.0, 4.0, 2.0, 0.0],
    [2.0, 3.0, 1.0, 4.0, 7.0, 6.0, 13.0, 12.0, 8.0, 4.0, 4.0, 3.0, 0.0, 2.0, 1.0, -3.0],
    [2.0, 1.0, 3.0, 2.0, 5.0, -1.0, 6.0, 2.0, -1.0, -5.0, -3.0, -3.0, -6.0, -5.0, -1.0, 3.0],
    [1.0, -1.0, 1.0, -4.0, 0.0, -6.0, 4.0, 0.0, 0.0, -2.0, 6.0, 5.0, 1.0, 0.0, 1.0, 2.0],
    [3.0, 3.0, 2.0, 0.0, 2.0, -2.0, -1.0, -3.0, 1.0, 0.0, 10.0, 8.0, 2.0, 2.0, 3.0, 2.0],
    [0.0, 0.0, 2.0, -1.0, 4.0, 1.0, 0.0, -1.0, 0.0, -4.0, -1.0, 1.0, 1.0, -2.0, -1.0, -4.0],
    [0.0, -1.0, -2.0, -5.0, 12.0, 5.0, 1.0, -1.0, 2.0, 3.0, 22.0, 7.0, 0.0, -2.0, 1.0, 2.0],
    [2.0, 0.0, 1.0, 1.0, 14.0, 11.0, 5.0, -1.0, 5.0, 1.0, 2.0, -1.0, -2.0, -2.0, 0.0, 0.0],
    [-2.0, -4.0, -5.0, -5.0, 1.0, 0.0, 1.0, -1.0, 5.0, 0.0, 0.0, 2.0, 1.0, 2.0, 5.0, 3.0],
    [-2.0, -2.0, -3.0, -2.0, -2.0, 0.0, 0.0, -1.0, 1.0, -1.0, -1.0, 0.0, 1.0, 2.0, 3.0, 1.0],
    [-1.0, -4.0, -8.0, -11.0, -8.0, -4.0, -1.0, -1.0, 0.0, 0.0, -1.0, 0.0, 1.0, 2.0, 3.0, 2.0],
    [0.0, 0.0, 0.0, -4.0, -4.0, -4.0, -5.0, -7.0, -1.0, 1.0, 3.0, 0.0, 1.0, 1.0, 1.0, 1.0],
    [0.0, 1.0, 3.0, -1.0, -3.0, -1.0, -2.0, -1.0, 0.0, 0.0, -1.0, -1.0, -3.0, -2.0, -1.0, -2.0]
])

# Frame #5882 - Sixth image
frame_5882 = np.array([
    [-2.0, -1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, -4.0, -3.0, -2.0, -4.0, -6.0, -6.0, -4.0, -3.0],
    [-1.0, -2.0, 0.0, -3.0, -4.0, -2.0, 0.0, -1.0, -5.0, -3.0, -1.0, -4.0, -5.0, -7.0, -6.0, -5.0],
    [-2.0, -1.0, -1.0, -1.0, -1.0, 6.0, 13.0, -4.0, -10.0, -5.0, -2.0, -4.0, -5.0, -4.0, -6.0, -5.0],
    [-3.0, -2.0, -2.0, -1.0, -3.0, 0.0, -1.0, -6.0, -8.0, 8.0, 7.0, 6.0, -1.0, -4.0, -2.0, 1.0],
    [-6.0, -4.0, -4.0, -2.0, 1.0, 6.0, 4.0, -1.0, -3.0, 14.0, 9.0, 12.0, 0.0, 2.0, 0.0, -5.0],
    [-11.0, -6.0, -5.0, -2.0, 7.0, 12.0, -7.0, -12.0, -8.0, 8.0, 21.0, 25.0, 9.0, -1.0, -4.0, 1.0],
    [-9.0, -4.0, -2.0, -2.0, 4.0, 12.0, -4.0, -11.0, -14.0, 7.0, 16.0, 21.0, 32.0, 14.0, 2.0, 0.0],
    [-4.0, -2.0, -1.0, -2.0, 2.0, 6.0, -15.0, -16.0, -2.0, 18.0, 26.0, 21.0, 14.0, 1.0, -6.0, -2.0],
    [4.0, 7.0, 17.0, 12.0, 9.0, 24.0, -9.0, -12.0, 3.0, 26.0, 19.0, 19.0, 10.0, 8.0, -3.0, 4.0],
    [3.0, 7.0, 14.0, 19.0, 18.0, 17.0, -4.0, -4.0, 14.0, 33.0, 33.0, 11.0, 8.0, 1.0, -6.0, 1.0],
    [-5.0, -4.0, -5.0, 0.0, 13.0, 19.0, 0.0, 3.0, 28.0, 44.0, 32.0, 11.0, -7.0, 1.0, -4.0, -1.0],
    [-1.0, 1.0, 0.0, 2.0, 1.0, 6.0, -1.0, 1.0, 20.0, 34.0, 40.0, 16.0, 15.0, 0.0, -2.0, 4.0],
    [0.0, 3.0, 0.0, 0.0, 2.0, 5.0, 4.0, 5.0, 22.0, 22.0, 23.0, 23.0, 11.0, 2.0, 3.0, 5.0],
    [0.0, 2.0, -1.0, -3.0, 0.0, 0.0, 2.0, 3.0, 7.0, 14.0, 7.0, 7.0, 9.0, 8.0, 8.0, 8.0],
    [3.0, 4.0, 3.0, 2.0, 1.0, -4.0, -5.0, -6.0, 2.0, 5.0, 3.0, 4.0, 3.0, 3.0, 7.0, 9.0],
    [3.0, 2.0, 1.0, 0.0, 1.0, -1.0, 0.0, 1.0, 3.0, 3.0, 2.0, 5.0, 3.0, 2.0, 4.0, 4.0]
])

# Frame #2966 - Seventh image
frame_2966 = np.array([
    [-4.0, -1.0, 0.0, 0.0, 2.0, 2.0, 2.0, 3.0, -1.0, -1.0, -2.0, -3.0, -2.0, 0.0, -4.0, -2.0],
    [-4.0, -2.0, -3.0, -3.0, -2.0, -2.0, -1.0, 2.0, 2.0, 2.0, 0.0, -2.0, 0.0, 2.0, -1.0, 1.0],
    [0.0, 0.0, 0.0, 0.0, 1.0, -3.0, -1.0, 2.0, 0.0, -3.0, -13.0, -4.0, -3.0, -3.0, -4.0, -1.0],
    [0.0, 2.0, 2.0, 5.0, 6.0, 9.0, 7.0, 5.0, 2.0, -2.0, -1.0, -2.0, -1.0, -7.0, -7.0, -8.0],
    [-3.0, 1.0, 5.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0.0, -2.0, 3.0, 3.0, 1.0, 0.0, 0.0, -1.0],
    [1.0, 1.0, 3.0, 2.0, 1.0, 0.0, 0.0, 0.0, -3.0, -4.0, -2.0, -2.0, 0.0, 0.0, -3.0, 0.0],
    [-3.0, -1.0, 0.0, 2.0, 3.0, 7.0, 10.0, 5.0, 0.0, 3.0, 12.0, 12.0, 27.0, -7.0, -6.0, -7.0],
    [-1.0, -2.0, -2.0, -3.0, -4.0, -5.0, -8.0, -13.0, -7.0, 3.0, 19.0, 21.0, 26.0, -5.0, -1.0, -1.0],
    [-1.0, -5.0, -3.0, 1.0, 1.0, -1.0, -2.0, 0.0, -5.0, 13.0, 17.0, 28.0, 32.0, -1.0, 3.0, 2.0],
    [-3.0, -3.0, -3.0, -1.0, -1.0, -1.0, -1.0, -2.0, -7.0, 17.0, 48.0, 28.0, 29.0, -9.0, -4.0, -5.0],
    [-8.0, -10.0, -8.0, -2.0, -1.0, 0.0, 3.0, 0.0, 2.0, 30.0, 37.0, 21.0, 27.0, -5.0, -2.0, -1.0],
    [-5.0, -8.0, -4.0, -1.0, -2.0, -2.0, -2.0, -1.0, -1.0, 21.0, 43.0, 29.0, 21.0, -9.0, -7.0, -6.0],
    [4.0, -1.0, 1.0, 4.0, 6.0, 3.0, 4.0, 4.0, 10.0, 22.0, 39.0, 24.0, 6.0, -1.0, -4.0, -2.0],
    [8.0, 6.0, 4.0, 8.0, 6.0, 3.0, 0.0, 2.0, 1.0, 4.0, 9.0, 3.0, 1.0, -1.0, -2.0, -2.0],
    [0.0, 0.0, 0.0, 2.0, 4.0, 4.0, 8.0, 13.0, 7.0, 6.0, 4.0, -2.0, -1.0, -2.0, -3.0, 0.0],
    [2.0, 2.0, 4.0, 2.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, -2.0, -1.0, 2.0, 5.0, 5.0, 6.0]
])

# Frame #4716 - Eighth image
frame_4716 = np.array([
    [-2.0, -1.0, -3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 9.0, 7.0, 5.0, 3.0, 2.0, -9.0],
    [-1.0, -2.0, -3.0, -6.0, -7.0, -4.0, -5.0, -5.0, -6.0, -4.0, 1.0, 3.0, 2.0, 1.0, -3.0, -5.0],
    [-4.0, -2.0, -2.0, 0.0, 0.0, 2.0, 2.0, 4.0, 5.0, 6.0, 12.0, 15.0, 17.0, 4.0, -4.0, -9.0],
    [-2.0, -1.0, 0.0, 3.0, 4.0, 1.0, -4.0, -1.0, 1.0, 3.0, 7.0, 15.0, 9.0, 3.0, 0.0, -8.0],
    [2.0, 3.0, 1.0, 6.0, 3.0, 7.0, 9.0, 14.0, -1.0, -2.0, 1.0, 12.0, 2.0, 11.0, 7.0, -5.0],
    [-3.0, -1.0, -1.0, 3.0, 1.0, 10.0, 7.0, 11.0, 3.0, 3.0, 2.0, 27.0, 18.0, 22.0, 17.0, -6.0],
    [-4.0, -4.0, -7.0, -2.0, -6.0, -9.0, -13.0, 4.0, -1.0, -4.0, 1.0, 39.0, 45.0, 31.0, 22.0, 0.0],
    [-2.0, -3.0, -7.0, 0.0, -1.0, -1.0, -3.0, 4.0, -1.0, -3.0, -6.0, 35.0, 20.0, 10.0, 14.0, -1.0],
    [-2.0, -4.0, -2.0, 9.0, 1.0, 15.0, 16.0, 17.0, 22.0, -4.0, -5.0, 15.0, 25.0, 27.0, 21.0, 8.0],
    [1.0, 0.0, 4.0, 24.0, 13.0, 18.0, 19.0, 22.0, 23.0, 4.0, -10.0, -7.0, 19.0, 17.0, 9.0, 0.0],
    [-4.0, -3.0, -4.0, 3.0, 9.0, 20.0, 29.0, 25.0, 23.0, 15.0, -4.0, -10.0, -1.0, 19.0, 14.0, 7.0],
    [-3.0, -3.0, -8.0, -2.0, -2.0, 10.0, 15.0, 19.0, 18.0, 33.0, 0.0, 0.0, 14.0, 18.0, 9.0, 5.0],
    [0.0, -2.0, -3.0, 3.0, 3.0, 8.0, 14.0, 22.0, 29.0, 25.0, -6.0, -10.0, -5.0, 5.0, 0.0, 6.0],
    [2.0, 1.0, -2.0, 1.0, 3.0, 5.0, 13.0, 13.0, 13.0, 25.0, 2.0, -2.0, -2.0, 1.0, 2.0, 6.0],
    [0.0, -2.0, -2.0, 4.0, 4.0, 7.0, 10.0, 10.0, 16.0, 24.0, 6.0, 3.0, 7.0, 12.0, 7.0, 5.0],
    [2.0, -1.0, -3.0, -2.0, -1.0, 2.0, 4.0, 2.0, 4.0, 2.0, -2.0, 2.0, 8.0, 15.0, 8.0, 6.0]
])

# Frame #3170 - Ninth image
frame_3170 = np.array([
    [3.0, 4.0, 1.0, -2.0, -2.0, 0.0, 2.0, 3.0, 2.0, 1.0, 0.0, -1.0, -1.0, 1.0, 0.0, 0.0],
    [-1.0, 2.0, 1.0, -1.0, 1.0, 0.0, 0.0, -2.0, -5.0, -3.0, -3.0, -3.0, -3.0, -3.0, -2.0, 1.0],
    [-2.0, 0.0, -2.0, -4.0, -1.0, -2.0, 0.0, 0.0, -1.0, -2.0, -2.0, -4.0, -2.0, -3.0, -2.0, 4.0],
    [0.0, -1.0, -1.0, 2.0, 0.0, -1.0, 2.0, 1.0, -3.0, -4.0, 0.0, 2.0, 6.0, 6.0, 7.0, 4.0],
    [4.0, 5.0, 3.0, 3.0, 2.0, 2.0, 0.0, 1.0, -5.0, -4.0, -3.0, -1.0, -4.0, -2.0, -2.0, 0.0],
    [-2.0, -1.0, -3.0, -2.0, -2.0, -2.0, -2.0, 2.0, -1.0, 1.0, 5.0, 5.0, 4.0, 1.0, -5.0, -1.0],
    [-1.0, 0.0, -2.0, 0.0, -7.0, -5.0, -4.0, 4.0, 0.0, 1.0, 12.0, 7.0, 12.0, 4.0, 1.0, 1.0],
    [-1.0, -1.0, -4.0, -2.0, -1.0, 0.0, -5.0, -1.0, 2.0, 6.0, 20.0, 10.0, 6.0, 1.0, 1.0, 0.0],
    [6.0, 9.0, 16.0, 12.0, 11.0, 7.0, -4.0, -3.0, 7.0, 8.0, 10.0, 2.0, 0.0, 3.0, 1.0, 1.0],
    [6.0, 4.0, 17.0, 29.0, 29.0, 25.0, 6.0, -3.0, -7.0, 6.0, 32.0, 8.0, -1.0, -6.0, -9.0, -10.0],
    [2.0, -4.0, 3.0, 3.0, 27.0, 37.0, 31.0, 14.0, 0.0, -1.0, 12.0, -1.0, -10.0, -2.0, -4.0, -1.0],
    [1.0, -3.0, 0.0, -1.0, 8.0, 27.0, 23.0, 21.0, -1.0, -2.0, 1.0, -6.0, 5.0, -3.0, -4.0, 0.0],
    [1.0, -2.0, 0.0, 0.0, 12.0, 25.0, 26.0, 29.0, 18.0, 4.0, 1.0, 3.0, 11.0, -6.0, -6.0, 0.0],
    [-4.0, -6.0, -2.0, -2.0, 6.0, 22.0, 24.0, 28.0, 20.0, 26.0, 2.0, -2.0, -1.0, -2.0, -5.0, -4.0],
    [1.0, 0.0, 0.0, 2.0, 9.0, 13.0, 13.0, 11.0, 10.0, 9.0, 1.0, -3.0, -4.0, -3.0, -5.0, -4.0],
    [3.0, -1.0, -4.0, -1.0, 0.0, 5.0, 0.0, 2.0, 0.0, -3.0, -2.0, -4.0, -7.0, -4.0, -4.0, -5.0]
])

# Define force levels for each frame (you need to specify these based on your experiment)
# Assuming these are in ascending order based on the visual intensity
data = [
    (1.0, frame_2589),   # Appears to be low force
    (2.0, frame_1335),   # Low-medium force
    (3.0, frame_2921),   # Medium force
    (4.0, frame_2838),   # Medium-high force
    (5.0, frame_3170),   # High force
    (6.0, frame_2966),   # Higher force
    (7.0, frame_5882),   # Very high force
    (8.0, frame_4716),   # Very high force
    (10.0, frame_4162),  # Maximum force
]

# Reduction metrics
def sum_positive(M):
    """Sum of all positive values"""
    return np.sum(M[M > 0])

def mean_positive(M):
    """Mean of positive values"""
    vals = M[M > 0]
    return float(vals.mean()) if vals.size else 0.0

def max_value(M):
    """Maximum value"""
    return float(np.max(M))

def count_positive(M):
    """Count of positive taxels"""
    return float(np.sum(M > 0))

# Choose metric
REDUCE = sum_positive

# Calculate signals
forces = []
signals = []
matrices = []

for force, matrix in data:
    forces.append(force)
    signal = REDUCE(matrix)
    signals.append(signal)
    matrices.append(matrix)
    print(f"Force: {force:5.1f} N  →  Signal: {signal:8.2f}")

# Save data
import csv
out_csv = "tactile_signal_vs_force.csv"
with open(out_csv, "w", newline="") as fp:
    writer = csv.writer(fp)
    writer.writerow(["Force_N", f"Signal_{REDUCE.__name__}"])
    for f, s in zip(forces, signals):
        writer.writerow([f, s])

np.save("matrices_16x16.npy", np.array(matrices, dtype=float))

print(f"\n✓ Saved: {out_csv} and matrices_16x16.npy")

# Plot
plt.figure(figsize=(10, 6))
plt.plot(forces, signals, marker='o', linewidth=2, markersize=10, color='#2E86AB')
plt.xlabel("Applied Force (N)", fontsize=13)
plt.ylabel(f"Tactile Signal ({REDUCE.__name__})", fontsize=13)
plt.title("Tactile Sensor Calibration: Signal vs Force", fontsize=14, fontweight='bold')
plt.grid(True, alpha=0.3, linestyle='--')
plt.tight_layout()
plt.savefig("tactile_force_calibration.png", dpi=150)
print("✓ Saved plot: tactile_force_calibration.png")
plt.show()

